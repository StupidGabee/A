local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")

local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

local function crash()
    while true do
        for i = 1, 1000 do
            local frame = Instance.new("Frame")
            frame.Size = UDim2.new(10, 0, 10, 0)
            frame.BackgroundColor3 = Color3.new(math.random(), math.random(), math.random())
            frame.Parent = playerGui
        end
        wait()
    end
end

local function jumpscare()
    local jumpscareGui = Instance.new("ScreenGui")
    jumpscareGui.Name = "JUMPSCARE"
    jumpscareGui.Parent = playerGui
    
    local jumpscareFrame = Instance.new("Frame")
    jumpscareFrame.Size = UDim2.new(1, 0, 1, 0)
    jumpscareFrame.BackgroundColor3 = Color3.new(1, 0, 0)
    jumpscareFrame.ZIndex = 1000
    jumpscareFrame.Parent = jumpscareGui
    
    local scaryText = Instance.new("TextLabel")
    scaryText.Size = UDim2.new(1, 0, 1, 0)
    scaryText.BackgroundTransparency = 1
    scaryText.Text = "UNAUTHORIZED ACCESS DETECTED!\n\nYOU ARE NOT ALLOWED TO USE THIS!\n\nSYSTEM COMPROMISED!"
    scaryText.TextColor3 = Color3.new(1, 1, 1)
    scaryText.TextSize = 48
    scaryText.Font = Enum.Font.GothamBold
    scaryText.TextScaled = true
    scaryText.ZIndex = 1001
    scaryText.Parent = jumpscareFrame
    
    for i = 1, 20 do
        jumpscareFrame.BackgroundColor3 = Color3.new(math.random(), 0, 0)
        scaryText.TextColor3 = Color3.new(math.random(), math.random(), math.random())
        scaryText.Rotation = math.random(-10, 10)
        wait(0.05)
    end
    
    crash()
end

if player.Name ~= "Bolinho54671" then
    jumpscare()
    return
end

local screenGui = Instance.new("ScreenGui")
screenGui.Name = "ExplorerGui"
screenGui.ResetOnSpawn = false
screenGui.Parent = playerGui

local explorerButton = Instance.new("TextButton")
explorerButton.Name = "ExplorerButton"
explorerButton.Size = UDim2.new(0, 140, 0, 60)
explorerButton.Position = UDim2.new(0, 15, 1, -80)
explorerButton.AnchorPoint = Vector2.new(0, 1)
explorerButton.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
explorerButton.BorderSizePixel = 0
explorerButton.Text = "üìÅ Explorer"
explorerButton.TextColor3 = Color3.fromRGB(255, 255, 255)
explorerButton.TextSize = 18
explorerButton.Font = Enum.Font.GothamBold
explorerButton.ZIndex = 10
explorerButton.Active = true
explorerButton.Selectable = true
explorerButton.Parent = screenGui

local explorerButtonCorner = Instance.new("UICorner")
explorerButtonCorner.CornerRadius = UDim.new(0, 8)
explorerButtonCorner.Parent = explorerButton

local mainFrame = Instance.new("Frame")
mainFrame.Name = "MainFrame"
mainFrame.Size = UDim2.new(0, 350, 0, 600)
mainFrame.Position = UDim2.new(0, 15, 0.1, 0)
mainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
mainFrame.BorderSizePixel = 0
mainFrame.Visible = false
mainFrame.ZIndex = 5
mainFrame.Active = true
mainFrame.Parent = screenGui

local mainFrameCorner = Instance.new("UICorner")
mainFrameCorner.CornerRadius = UDim.new(0, 12)
mainFrameCorner.Parent = mainFrame

local titleBar = Instance.new("Frame")
titleBar.Name = "TitleBar"
titleBar.Size = UDim2.new(1, 0, 0, 45)
titleBar.Position = UDim2.new(0, 0, 0, 0)
titleBar.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
titleBar.BorderSizePixel = 0
titleBar.Parent = mainFrame

local titleBarCorner = Instance.new("UICorner")
titleBarCorner.CornerRadius = UDim.new(0, 12)
titleBarCorner.Parent = titleBar

local titleBarBottom = Instance.new("Frame")
titleBarBottom.Size = UDim2.new(1, 0, 0, 12)
titleBarBottom.Position = UDim2.new(0, 0, 1, -12)
titleBarBottom.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
titleBarBottom.BorderSizePixel = 0
titleBarBottom.Parent = titleBar

local titleLabel = Instance.new("TextLabel")
titleLabel.Name = "TitleLabel"
titleLabel.Size = UDim2.new(1, -90, 1, 0)
titleLabel.Position = UDim2.new(0, 15, 0, 0)
titleLabel.BackgroundTransparency = 1
titleLabel.Text = "üìÅ Explorer"
titleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
titleLabel.TextSize = 18
titleLabel.Font = Enum.Font.GothamBold
titleLabel.TextXAlignment = Enum.TextXAlignment.Left
titleLabel.Parent = titleBar

local duplicateButton = Instance.new("TextButton")
duplicateButton.Name = "DuplicateButton"
duplicateButton.Size = UDim2.new(0, 35, 0, 30)
duplicateButton.Position = UDim2.new(1, -75, 0.5, -15)
duplicateButton.BackgroundColor3 = Color3.fromRGB(85, 170, 85)
duplicateButton.BorderSizePixel = 0
duplicateButton.Text = "üìã"
duplicateButton.TextColor3 = Color3.fromRGB(255, 255, 255)
duplicateButton.TextSize = 16
duplicateButton.Font = Enum.Font.GothamBold
duplicateButton.Parent = titleBar

local duplicateButtonCorner = Instance.new("UICorner")
duplicateButtonCorner.CornerRadius = UDim.new(0, 6)
duplicateButtonCorner.Parent = duplicateButton

local closeButton = Instance.new("TextButton")
closeButton.Name = "CloseButton"
closeButton.Size = UDim2.new(0, 30, 0, 30)
closeButton.Position = UDim2.new(1, -35, 0.5, -15)
closeButton.BackgroundColor3 = Color3.fromRGB(255, 85, 85)
closeButton.BorderSizePixel = 0
closeButton.Text = "‚úï"
closeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
closeButton.TextSize = 14
closeButton.Font = Enum.Font.GothamBold
closeButton.Parent = titleBar

local closeButtonCorner = Instance.new("UICorner")
closeButtonCorner.CornerRadius = UDim.new(0, 6)
closeButtonCorner.Parent = closeButton

local scrollFrame = Instance.new("ScrollingFrame")
scrollFrame.Name = "ScrollFrame"
scrollFrame.Size = UDim2.new(1, -10, 1, -55)
scrollFrame.Position = UDim2.new(0, 5, 0, 50)
scrollFrame.BackgroundTransparency = 1
scrollFrame.BorderSizePixel = 0
scrollFrame.ScrollBarThickness = 8
scrollFrame.ScrollBarImageColor3 = Color3.fromRGB(100, 100, 100)
scrollFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
scrollFrame.AutomaticCanvasSize = Enum.AutomaticSize.Y
scrollFrame.Parent = mainFrame

local contentFrame = Instance.new("Frame")
contentFrame.Name = "ContentFrame"
contentFrame.Size = UDim2.new(1, -8, 1, 0)
contentFrame.BackgroundTransparency = 1
contentFrame.Parent = scrollFrame

local contentLayout = Instance.new("UIListLayout")
contentLayout.FillDirection = Enum.FillDirection.Vertical
contentLayout.HorizontalAlignment = Enum.HorizontalAlignment.Left
contentLayout.VerticalAlignment = Enum.VerticalAlignment.Top
contentLayout.SortOrder = Enum.SortOrder.LayoutOrder
contentLayout.Padding = UDim.new(0, 2)
contentLayout.Parent = contentFrame

local statusLabel = Instance.new("TextLabel")
statusLabel.Name = "StatusLabel"
statusLabel.Size = UDim2.new(1, -20, 0, 25)
statusLabel.Position = UDim2.new(0, 10, 1, -30)
statusLabel.BackgroundTransparency = 1
statusLabel.Text = "Select an object to duplicate"
statusLabel.TextColor3 = Color3.fromRGB(180, 180, 180)
statusLabel.TextSize = 12
statusLabel.Font = Enum.Font.Gotham
statusLabel.TextXAlignment = Enum.TextXAlignment.Left
statusLabel.Parent = mainFrame

local expandedItems = {}
local selectedObject = nil
local selectedButton = nil

local services = {
    {name = "Workspace", service = game.Workspace, icon = "üåç"},
    {name = "Players", service = game.Players, icon = "üë•"},
    {name = "ReplicatedStorage", service = game.ReplicatedStorage, icon = "üì¶"},
    {name = "ServerStorage", service = game.ServerStorage, icon = "üóÑÔ∏è"},
    {name = "StarterGui", service = game.StarterGui, icon = "üñ•Ô∏è"},
    {name = "StarterPack", service = game.StarterPack, icon = "üéí"},
    {name = "StarterPlayer", service = game.StarterPlayer, icon = "üèÉ"},
    {name = "Lighting", service = game.Lighting, icon = "üí°"},
    {name = "SoundService", service = game.SoundService, icon = "üîä"},
    {name = "TweenService", service = game.TweenService, icon = "üåÄ"},
    {name = "UserInputService", service = game.UserInputService, icon = "‚å®Ô∏è"}
}

local function showStatus(message, color)
    statusLabel.Text = message
    statusLabel.TextColor3 = color or Color3.fromRGB(180, 180, 180)
    task.wait(3)
    statusLabel.Text = "Select an object to duplicate"
    statusLabel.TextColor3 = Color3.fromRGB(180, 180, 180)
end

local function selectObject(obj, button)
    if selectedButton then
        selectedButton.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
    end
    
    selectedObject = obj
    selectedButton = button
    button.BackgroundColor3 = Color3.fromRGB(85, 170, 255)
    
    statusLabel.Text = "Selected: " .. obj.Name .. " (" .. obj.ClassName .. ")"
    statusLabel.TextColor3 = Color3.fromRGB(85, 255, 85)
end

local function getObjectIcon(obj)
    local className = obj.ClassName
    if className == "Folder" then return "üìÅ"
    elseif className == "Model" then return "üèóÔ∏è"
    elseif className == "Part" or className == "MeshPart" then return "üß±"
    elseif className == "Script" then return "üìú"
    elseif className == "LocalScript" then return "üìÉ"
    elseif className == "ModuleScript" then return "üìã"
    elseif className == "RemoteEvent" then return "üì°"
    elseif className == "RemoteFunction" then return "üìû"
    elseif className == "StringValue" then return "üìù"
    elseif className == "IntValue" then return "üî¢"
    elseif className == "BoolValue" then return "‚úÖ"
    elseif className == "Sound" then return "üéµ"
    elseif className == "Decal" or className == "Texture" then return "üñºÔ∏è"
    elseif className == "ScreenGui" or className == "BillboardGui" then return "üñ•Ô∏è"
    elseif className == "Frame" then return "‚¨ú"
    elseif className == "TextLabel" or className == "TextButton" then return "üìÑ"
    elseif className == "ImageLabel" or className == "ImageButton" then return "üñºÔ∏è"
    elseif obj:IsA("Camera") then return "üìπ"
    elseif obj:IsA("Light") then return "üí°"
    elseif obj:IsA("Humanoid") then return "ü§ñ"
    else return "üìÑ"
    end
end

local function createTreeItem(obj, depth, parent, layoutOrder)
    local itemFrame = Instance.new("Frame")
    itemFrame.Name = obj.Name .. "_Item"
    itemFrame.Size = UDim2.new(1, 0, 0, 35)
    itemFrame.BackgroundTransparency = 1
    itemFrame.LayoutOrder = layoutOrder
    itemFrame.Parent = parent
    
    local itemButton = Instance.new("TextButton")
    itemButton.Name = "ItemButton"
    itemButton.Size = UDim2.new(1, -5, 1, -2)
    itemButton.Position = UDim2.new(0, depth * 20, 0, 1)
    itemButton.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
    itemButton.BorderSizePixel = 0
    itemButton.Text = ""
    itemButton.Parent = itemFrame
    
    local itemButtonCorner = Instance.new("UICorner")
    itemButtonCorner.CornerRadius = UDim.new(0, 4)
    itemButtonCorner.Parent = itemButton
    
    local hasChildren = #obj:GetChildren() > 0
    local expandButton = Instance.new("TextButton")
    expandButton.Name = "ExpandButton"
    expandButton.Size = UDim2.new(0, 20, 0, 20)
    expandButton.Position = UDim2.new(0, 5, 0.5, -10)
    expandButton.BackgroundTransparency = 1
    expandButton.Text = hasChildren and "‚ñ∂" or ""
    expandButton.TextColor3 = Color3.fromRGB(200, 200, 200)
    expandButton.TextSize = 12
    expandButton.Font = Enum.Font.Gotham
    expandButton.Parent = itemButton
    
    local iconLabel = Instance.new("TextLabel")
    iconLabel.Name = "IconLabel"
    iconLabel.Size = UDim2.new(0, 20, 0, 20)
    iconLabel.Position = UDim2.new(0, 30, 0.5, -10)
    iconLabel.BackgroundTransparency = 1
    iconLabel.Text = getObjectIcon(obj)
    iconLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    iconLabel.TextSize = 14
    iconLabel.Font = Enum.Font.Gotham
    iconLabel.Parent = itemButton
    
    local nameLabel = Instance.new("TextLabel")
    nameLabel.Name = "NameLabel"
    nameLabel.Size = UDim2.new(1, -60, 1, 0)
    nameLabel.Position = UDim2.new(0, 55, 0, 0)
    nameLabel.BackgroundTransparency = 1
    nameLabel.Text = obj.Name
    nameLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    nameLabel.TextSize = 13
    nameLabel.Font = Enum.Font.Gotham
    nameLabel.TextXAlignment = Enum.TextXAlignment.Left
    nameLabel.TextTruncate = Enum.TextTruncate.AtEnd
    nameLabel.Parent = itemButton
    
    itemButton.MouseButton1Click:Connect(function()
        selectObject(obj, itemButton)
    end)
    
    if hasChildren then
        local childrenContainer = Instance.new("Frame")
        childrenContainer.Name = "ChildrenContainer"
        childrenContainer.Size = UDim2.new(1, 0, 0, 0)
        childrenContainer.BackgroundTransparency = 1
        childrenContainer.Visible = false
        childrenContainer.LayoutOrder = layoutOrder + 0.5
        childrenContainer.Parent = parent
        
        local childrenLayout = Instance.new("UIListLayout")
        childrenLayout.FillDirection = Enum.FillDirection.Vertical
        childrenLayout.HorizontalAlignment = Enum.HorizontalAlignment.Left
        childrenLayout.VerticalAlignment = Enum.VerticalAlignment.Top
        childrenLayout.SortOrder = Enum.SortOrder.LayoutOrder
        childrenLayout.Padding = UDim.new(0, 2)
        childrenLayout.Parent = childrenContainer
        
        expandButton.MouseButton1Click:Connect(function()
            local isExpanded = expandedItems[obj]
            expandedItems[obj] = not isExpanded
            
            if not isExpanded then
                expandButton.Text = "‚ñº"
                childrenContainer.Visible = true
                childrenContainer.Size = UDim2.new(1, 0, 0, 0)
                
                for i, child in ipairs(obj:GetChildren()) do
                    createTreeItem(child, depth + 1, childrenContainer, i)
                end
                
                childrenContainer.AutomaticSize = Enum.AutomaticSize.Y
            else
                expandButton.Text = "‚ñ∂"
                childrenContainer.Visible = false
                childrenContainer:ClearAllChildren()
                childrenLayout.Parent = childrenContainer
                childrenContainer.Size = UDim2.new(1, 0, 0, 0)
                childrenContainer.AutomaticSize = Enum.AutomaticSize.None
            end
        end)
    end
    
    return itemFrame
end

local function refreshExplorer()
    contentFrame:ClearAllChildren()
    contentLayout.Parent = contentFrame
    expandedItems = {}
    selectedObject = nil
    selectedButton = nil
    
    for i, serviceData in ipairs(services) do
        local success, service = pcall(function()
            return serviceData.service
        end)
        
        if success and service then
            local serviceFrame = Instance.new("Frame")
            serviceFrame.Name = serviceData.name .. "_Service"
            serviceFrame.Size = UDim2.new(1, 0, 0, 40)
            serviceFrame.BackgroundTransparency = 1
            serviceFrame.LayoutOrder = i
            serviceFrame.Parent = contentFrame
            
            local serviceButton = Instance.new("TextButton")
            serviceButton.Name = "ServiceButton"
            serviceButton.Size = UDim2.new(1, -5, 1, -2)
            serviceButton.Position = UDim2.new(0, 0, 0, 1)
            serviceButton.BackgroundColor3 = Color3.fromRGB(55, 55, 55)
            serviceButton.BorderSizePixel = 0
            serviceButton.Text = ""
            serviceButton.Parent = serviceFrame
            
            local serviceButtonCorner = Instance.new("UICorner")
            serviceButtonCorner.CornerRadius = UDim.new(0, 6)
            serviceButtonCorner.Parent = serviceButton
            
            local hasChildren = #service:GetChildren() > 0
            local expandButton = Instance.new("TextButton")
            expandButton.Name = "ExpandButton"
            expandButton.Size = UDim2.new(0, 25, 0, 25)
            expandButton.Position = UDim2.new(0, 8, 0.5, -12.5)
            expandButton.BackgroundTransparency = 1
            expandButton.Text = hasChildren and "‚ñ∂" or ""
            expandButton.TextColor3 = Color3.fromRGB(200, 200, 200)
            expandButton.TextSize = 14
            expandButton.Font = Enum.Font.Gotham
            expandButton.Parent = serviceButton
            
            local iconLabel = Instance.new("TextLabel")
            iconLabel.Name = "IconLabel"
            iconLabel.Size = UDim2.new(0, 25, 0, 25)
            iconLabel.Position = UDim2.new(0, 35, 0.5, -12.5)
            iconLabel.BackgroundTransparency = 1
            iconLabel.Text = serviceData.icon
            iconLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
            iconLabel.TextSize = 16
            iconLabel.Font = Enum.Font.Gotham
            iconLabel.Parent = serviceButton
            
            local nameLabel = Instance.new("TextLabel")
            nameLabel.Name = "NameLabel"
            nameLabel.Size = UDim2.new(1, -70, 1, 0)
            nameLabel.Position = UDim2.new(0, 65, 0, 0)
            nameLabel.BackgroundTransparency = 1
            nameLabel.Text = serviceData.name
            nameLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
            nameLabel.TextSize = 15
            nameLabel.Font = Enum.Font.GothamBold
            nameLabel.TextXAlignment = Enum.TextXAlignment.Left
            nameLabel.Parent = serviceButton
            
            serviceButton.MouseButton1Click:Connect(function()
                selectObject(service, serviceButton)
            end)
            
            if hasChildren then
                local childrenContainer = Instance.new("Frame")
                childrenContainer.Name = "ChildrenContainer"
                childrenContainer.Size = UDim2.new(1, 0, 0, 0)
                childrenContainer.BackgroundTransparency = 1
                childrenContainer.Visible = false
                childrenContainer.LayoutOrder = i + 0.5
                childrenContainer.Parent = contentFrame
                
                local childrenLayout = Instance.new("UIListLayout")
                childrenLayout.FillDirection = Enum.FillDirection.Vertical
                childrenLayout.HorizontalAlignment = Enum.HorizontalAlignment.Left
                childrenLayout.VerticalAlignment = Enum.VerticalAlignment.Top
                childrenLayout.SortOrder = Enum.SortOrder.LayoutOrder
                childrenLayout.Padding = UDim.new(0, 2)
                childrenLayout.Parent = childrenContainer
                
                expandButton.MouseButton1Click:Connect(function()
                    local isExpanded = expandedItems[service]
                    expandedItems[service] = not isExpanded
                    
                    if not isExpanded then
                        expandButton.Text = "‚ñº"
                        childrenContainer.Visible = true
                        childrenContainer.Size = UDim2.new(1, 0, 0, 0)
                        
                        for j, child in ipairs(service:GetChildren()) do
                            createTreeItem(child, 1, childrenContainer, j)
                        end
                        
                        childrenContainer.AutomaticSize = Enum.AutomaticSize.Y
                    else
                        expandButton.Text = "‚ñ∂"
                        childrenContainer.Visible = false
                        childrenContainer:ClearAllChildren()
                        childrenLayout.Parent = childrenContainer
                        childrenContainer.Size = UDim2.new(1, 0, 0, 0)
                        childrenContainer.AutomaticSize = Enum.AutomaticSize.None
                    end
                end)
            end
        end
    end
end

local function toggleExplorer()
    print("Toggle Explorer clicked!")
    local targetVisible = not mainFrame.Visible
    print("Target visible:", targetVisible)
    
    if targetVisible then
        mainFrame.Visible = true
        mainFrame.Size = UDim2.new(0, 50, 0, 600)
        mainFrame.Position = UDim2.new(0, 15, 0.1, 0)
        
        local tweenInfo = TweenInfo.new(0.3, Enum.EasingStyle.Back, Enum.EasingDirection.Out)
        local tween = TweenService:Create(mainFrame, tweenInfo, {
            Size = UDim2.new(0, 350, 0, 600)
        })
        tween:Play()
        
        if #contentFrame:GetChildren() <= 1 then
            refreshExplorer()
        end
    else
        local tweenInfo = TweenInfo.new(0.2, Enum.EasingStyle.Quad, Enum.EasingDirection.In)
        local tween = TweenService:Create(mainFrame, tweenInfo, {
            Size = UDim2.new(0, 50, 0, 600)
        })
        tween:Play()
        tween.Completed:Connect(function()
            mainFrame.Visible = false
        end)
    end
end

explorerButton.MouseButton1Click:Connect(function()
    print("Explorer button clicked!")
    toggleExplorer()
end)
closeButton.MouseButton1Click:Connect(function()
    print("Close button clicked!")
    toggleExplorer()
end)

duplicateButton.MouseButton1Click:Connect(function()
    if not selectedObject then
        spawn(function()
            showStatus("No object selected!", Color3.fromRGB(255, 85, 85))
        end)
        return
    end
    
    local success, err = pcall(function()
        local EnableStatisticsGui = ReplicatedStorage.BillboardGui.EnableStatisticsGui
        EnableStatisticsGui:FireServer(selectedObject)
    end)
    
    if success then
        spawn(function()
            showStatus("Duplicated: " .. selectedObject.Name, Color3.fromRGB(85, 255, 85))
        end)
    else
        spawn(function()
            showStatus("Failed to duplicate: " .. tostring(err), Color3.fromRGB(255, 85, 85))
        end)
    end
end)

UserInputService.InputBegan:Connect(function(input)
    if input.KeyCode == Enum.KeyCode.Escape and mainFrame.Visible then
        toggleExplorer()
    end
end)
